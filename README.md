# üöÄ FastAPI Image Management System

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π S3, CDN –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –û–¥–∏–Ω —Ñ–∞–π–ª - –≤—Å—è —Å–∏—Å—Ç–µ–º–∞!
```bash
# Windows
start.bat

# Linux/Mac
start.sh

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
python scripts/system_launcher.py
```

**–ó–∞–ø—É—Å–∫–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úÖ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ—Ä—Ç 8000)
- ‚úÖ PostgreSQL (–ø–æ—Ä—Ç 5432)
- ‚úÖ MinIO S3 (–ø–æ—Ä—Ç 9000)
- ‚úÖ Redis (–ø–æ—Ä—Ç 6379)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env

## üåü –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üì∏ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ API
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (resize, optimize)
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã (thumb, small, medium, large)
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### üíæ –ì–∏–±–∫–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- **–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** - –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **S3/MinIO** - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

### üåê CDN –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **–õ–æ–∫–∞–ª—å–Ω—ã–π CDN** - –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **CloudFlare** - –≥–æ—Ç–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- **AWS CloudFront** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### üîÑ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –§–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
FastAPI/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/v1/endpoints/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ images.py          # API –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cdn.py             # CDN endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ products.py        # –¢–æ–≤–∞—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ orders.py          # –ó–∞–∫–∞–∑—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ categories.py      # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ image_service.py   # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage_service.py # S3/–ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ image_processor.py # –§–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ local_cdn_service.py # –õ–æ–∫–∞–ª—å–Ω—ã–π CDN
‚îÇ   ‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/            # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sql/               # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ schemas/               # Pydantic —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ uploads/                   # –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
‚îú‚îÄ‚îÄ cdn_cache/                 # –ö—ç—à CDN
‚îú‚îÄ‚îÄ scripts/                   # üìÅ –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ system_launcher.py     # üöÄ –ï–¥–∏–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ start_system.bat       # Windows –∑–∞–ø—É—Å–∫
‚îÇ   ‚îú‚îÄ‚îÄ start_system.sh        # Linux/Mac –∑–∞–ø—É—Å–∫
‚îÇ   ‚îú‚îÄ‚îÄ image_migration.py     # üì¶ –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ setup_s3.sh           # üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ S3
‚îú‚îÄ‚îÄ start.bat                  # üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (Windows)
‚îú‚îÄ‚îÄ start.sh                   # üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (Linux/Mac)
‚îú‚îÄ‚îÄ docker-compose.yml         # Docker —Å–µ—Ä–≤–∏—Å—ã
‚îú‚îÄ‚îÄ requirements.txt           # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ó–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.8+
- Docker (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- Docker Compose (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repository>
cd FastAPI

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏—Å—Ç–µ–º—É
python scripts/system_launcher.py
```
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- üåê **FastAPI**: http://localhost:8000
- üìö **API Docs**: http://localhost:8000/docs
- üîç **Health**: http://localhost:8000/healthz
- üíæ **MinIO**: http://localhost:9001 (minioadmin/minioadmin)
- üìä **CDN Health**: http://localhost:8000/api/v1/cdn/health

## üìö API Endpoints

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
POST /api/v1/images/upload/{product_id}

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
GET /api/v1/images/{image_id}

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
PUT /api/v1/images/{image_id}

# –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
DELETE /api/v1/images/{image_id}
```

### CDN
```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ CDN
GET /api/v1/cdn/file/{file_path}?size=thumb

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞
GET /api/v1/cdn/stats/cache

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
POST /api/v1/cdn/cache/clear

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
GET /api/v1/cdn/health
```

### –¢–æ–≤–∞—Ä—ã
```bash
# –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
GET /api/v1/products

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
GET /api/v1/products/{product_id}

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
POST /api/v1/products

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
PUT /api/v1/products/{product_id}

# –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
DELETE /api/v1/products/{product_id}
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### .env —Ñ–∞–π–ª
```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL=postgresql+psycopg2://postgres:password@localhost:5432/fastapi_shop

# –•—Ä–∞–Ω–∏–ª–∏—â–µ
STORAGE_TYPE=local  # local –∏–ª–∏ s3
STORAGE_PATH=uploads
MAX_IMAGE_SIZE=10485760
ALLOWED_IMAGE_TYPES=jpg,jpeg,png,webp,gif

# S3 (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞)
S3_BUCKET_NAME=my-product-images-bucket
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key

# CDN
CDN_BASE_URL=https://cdn.yourdomain.com

# –û—Ç–ª–∞–¥–∫–∞
DEBUG=true
```

## üåê –ü—Ä–æ–¥–∞–∫—à–Ω –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### AWS S3 + CloudFlare
1. –°–æ–∑–¥–∞–π—Ç–µ S3 bucket
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CloudFlare CDN
3. –û–±–Ω–æ–≤–∏—Ç–µ .env —Ñ–∞–π–ª
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É

–ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: [S3_CDN_SETUP.md](S3_CDN_SETUP.md)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
```bash
curl http://localhost:8000/healthz
```

### –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```bash
curl -X POST "http://localhost:8000/api/v1/images/upload/test-product" \
  -F "file=@image.jpg" \
  -F "alt_text=–¢–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" \
  -F "is_primary=true"
```

### CDN —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```bash
curl http://localhost:8000/api/v1/cdn/stats/cache
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ CDN
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ –∫—ç—à–µ
- –†–∞–∑–º–µ—Ä –∫—ç—à–∞
- Hit/Miss ratio
- –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –†–∞–∑–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ MIME —Ç–∏–ø–æ–≤
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—É—Ç–∏ —Ñ–∞–π–ª–æ–≤
- CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Docker
```bash
docker-compose up -d
```

### Heroku
```bash
heroku create
git push heroku main
```

### AWS
```bash
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ EC2 + RDS + S3 + CloudFront
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ docker-compose.yml
```

## üìù TODO

- [ ] –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- [ ] Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –¢–µ—Å—Ç—ã
- [ ] Docker –æ–±—Ä–∞–∑
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è email/—Ç–µ–ª–µ—Ñ–æ–Ω–∞
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–∫–∞–∑–∞—Ö

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. Push –≤ branch
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- üìß Email: support@example.com
- üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [docs/](docs/)
- üêõ Issues: [GitHub Issues](https://github.com/example/fastapi-images/issues)

---

**–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏**
